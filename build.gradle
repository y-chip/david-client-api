plugins {
	id "org.openapi.generator" version "5.0.0"
}

task downloadApiSpec doLast {
	def file = new File("$projectDir/api-spec.json")
	file.delete()
	file.setText(groovy.json.JsonOutput.prettyPrint(
			new URL('http://localhost:8080/v3/api-docs').getText('UTF-8')), 'UTF-8')
}

openApiGenerate {
	generatorName = "typescript-angular"
	inputSpec = "$projectDir/api-spec.json".toString()
	outputDir = "$projectDir/src".toString()
	additionalProperties = [
			npmName: "@david/david-api",
			npmVersion: "1.0.0",
			ngVersion: "11.0.4",
			providedInRoot: "true"
	]
}
